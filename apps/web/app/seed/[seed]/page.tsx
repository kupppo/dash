import { stringToParams } from "core";
import Link from 'next/link'
import styles from './seed.module.css'
import Seed from './seed'
import { prefetchSignature } from 'core'
import Toaster from '../../components/toaster'

type SeedParams = {
  seed: string
}

export async function generateMetadata({ params }: { params : { seed: string }}) {
  const settings = stringToParams(params.seed)
  const seedNum = settings.seed
  const sig = prefetchSignature(seedNum)
  return {
    title: `DASH Randomizer Seed`,
    description: sig
  }
}

export default function SeedPage({ params }: { params: SeedParams}) {
  
  const SeedFooter = () => {
    return (
      <footer className={styles.footer}>
        <p>
          This seed was generated by
          <br />
          <Link href="/">DASH Randomizer</Link>
        </p>
      </footer>
    );
  };

  const settings = stringToParams(params.seed)
  const seedNum = settings.seed
  const sig = prefetchSignature(seedNum)

  return (
    <main className={styles.container}>
      <h1 className={styles.logo}>DASH</h1>
      <Seed
        parameters={settings}
        hash={params.seed}
        signature={sig}
      />
      <SeedFooter />
      <Toaster />
    </main>
  );
}
